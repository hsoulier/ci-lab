name: PR
run-name: PR ${{ github.ref_name }}
on:
  pull_request:
    types: [opened, reopened, synchronize, review_requested]

jobs:
  Prepare:
    uses: ./.github/workflows/base.yml
  Build:
    needs: Prepare
    uses: ./.github/workflows/build.yml
  Deploy:
    needs: Build
    uses: ./.github/workflows/test.yml
  Clean:
    runs-on: ubuntu-latest
    needs: Deploy
    steps:
      - name: ðŸ§¹ Clear cache with GIthub CLI
        run: gh cache list --repo $REPO | grep -e "build-nextjs" | cut -b 1-3 | xargs -L1 gh cache delete
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          REPO: ${{ github.repository }}
